---
# Source: golang-external-secrets/templates/golang-external-secrets-hub-serviceaccount-tmp.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: golang-external-secrets
  namespace: golang-external-secrets
---
# Source: golang-external-secrets/templates/golang-external-secrets-hub-clusterrolebinding.yaml
apiVersion: v1
kind: Secret
metadata:
  name: golang-external-secrets
  namespace: golang-external-secrets
  annotations:
    kubernetes.io/service-account.name: golang-external-secrets
type: kubernetes.io/service-account-token
---
# Source: golang-external-secrets/templates/golang-external-secrets-hub-clusterrolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: role-tokenreview-binding
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: system:auth-delegator
subjects:
- kind: ServiceAccount
  name: golang-external-secrets
  namespace: golang-external-secrets
---
# Source: golang-external-secrets/templates/golang-external-secrets-hub-serviceaccount-tmp.yaml
# Temporary service account since we disabled the subchart and the SA is needed
# by the vault unsealing playbook
---
# Source: golang-external-secrets/templates/golang-external-secrets-hub-secretstore.yaml
apiVersion: external-secrets.io/v1beta1
kind: ClusterSecretStore
metadata:
  name: vault-backend
  namespace: golang-external-secrets
spec:
  provider:
    vault:
      server: https://vault-vault.hub.example.com
      path: secret
      # Version of KV backend
      version: v2
      caProvider:
        type: ConfigMap
        name: kube-root-ca.crt
        key: ca.crt
        namespace: golang-external-secrets
      auth:
        kubernetes:
          mountPath: hub
          role: hub-role
          secretRef:
            name: golang-external-secrets
            namespace: golang-external-secrets
            key: "token"
